package com.citycreek.of;

import java.util.List;

public abstract class Exporter {

	private int count = 0;
	private char delimiter;
	protected final StringBuilder iff = new StringBuilder();

	public Exporter(char delimiter) {
		this.delimiter = delimiter;
	}

	public int getCount() {
		return this.count;
	}

	public abstract Exporter exportOrders(List<Order> orders);

	protected void column(String value, boolean quotes) {
		if (quotes) {
			this.iff.append("\"").append(value).append("\"").append(this.delimiter);
		} else {
			this.iff.append(value).append(this.delimiter);
		}
	}

	protected void column(String value) {
		this.column(value, true);
	}

	protected void column(Number value) {
		this.column(value.toString(), false);
	}

	protected void rowEnd() {
		this.iff.append("\n");
		this.count++;
	}

	protected void headerRow(String header) {
		this.iff.append(header).append("\n");
	}

	protected void skip() {
		this.iff.append(this.delimiter);
	}
}
